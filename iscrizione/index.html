<!DOCTYPE html>
<html lang="it">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Iscrizione Open Day</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/iscrizione.css">
</head>

<body>

  <section class="iscrizione-section">
    <div class="form-container">
      <h2>Iscriviti all'Open Day</h2>
      <p>Compila il modulo per riservare il tuo posto all’evento.</p>

      <form id="iscrizioneForm" class="iscrizione-form">
  <select name="data_evento" required>
    <option value="">Seleziona la data dell'Open Day</option>
    <option value="2025-10-03">3 Ottobre 2025</option>
    <option value="2025-10-17">17 Ottobre 2025</option>
  </select>
  <input type="text" name="nome" placeholder="Il tuo nome completo" required>
  <input type="email" name="email" id="email" placeholder="La tua email" required>
  <input type="tel" name="telefono" id="telefono" placeholder="Il tuo numero di telefono" required>
  <input type="date" name="data_nascita" id="data_nascita" required>

  <label class="checkbox">
    <input type="checkbox" name="privacy" required>
    Acconsento al trattamento dei dati personali
  </label>

  <label class="checkbox">
    <input type="checkbox" name="newsletter">
    Desidero ricevere aggiornamenti via email
  </label>

  <button type="submit" class="btn">Invia iscrizione</button>
</form>

    </div>
  </section>

<script>
  const form = document.getElementById("iscrizioneForm");
  const emailField = document.getElementById("email");
  const telField = document.getElementById("telefono");
  const dateField = document.getElementById("data_nascita");

  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;
  const telRegex = /^[0-9+\s]{10,15}$/;

  form.addEventListener("submit", async function(e) {
    e.preventDefault();

    // ✅ Validazione email
    if (!emailRegex.test(emailField.value)) {
      alert("Inserisci un indirizzo email valido.");
      emailField.focus();
      return;
    }

    // ✅ Validazione telefono
    if (!telRegex.test(telField.value)) {
      alert("Inserisci un numero di telefono valido (almeno 10 cifre).");
      telField.focus();
      return;
    }

    // ✅ Validazione data (non futura)
    const today = new Date().toISOString().split("T")[0];
    if (!dateField.value || dateField.value > today) {
      alert("Inserisci una data di nascita valida.");
      dateField.focus();
      return;
    }

    // ✅ Invio a Formspree
    const data = new FormData(form);
    try {
      const response = await fetch("https://formspree.io/f/xeorqakk", {
        method: "POST",
        body: data,
        headers: { "Accept": "application/json" }
      });

      if (response.ok) {
        // Redirect custom
        window.location.href = "https://itsbeyourcampus.it/grazie/";
      } else {
        alert("Errore nell'invio del form, riprova.");
      }
    } catch (error) {
      alert("Errore di connessione, riprova.");
    }
  });
</script>


</body>

</html>
